tinymce.PluginManager.add("pagebreak",function(e){var a,n="mce-pagebreak",t=e.getParam("pagebreak_separator","<!-- pagebreak -->"),r='<img src="'+tinymce.Env.transparentSrc+'" class="'+n+'" data-mce-resize="false" />';a=new RegExp(t.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(e){return"\\"+e}),"gi"),e.addCommand("mcePageBreak",function(){e.execCommand("mceInsertContent",0,r)}),e.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),e.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),e.on("ResolveName",function(a){"IMG"==a.target.nodeName&&e.dom.hasClass(a.target,n)&&(a.name="pagebreak")}),e.on("click",function(a){a=a.target,"IMG"===a.nodeName&&e.dom.hasClass(a,n)&&e.selection.select(a)}),e.on("BeforeSetContent",function(e){e.content=e.content.replace(a,r)}),e.on("PreInit",function(){e.serializer.addNodeFilter("img",function(e){for(var a,n,r=e.length;r--;)a=e[r],n=a.attr("class"),n&&-1!==n.indexOf("mce-pagebreak")&&(a.type=3,a.value=t,a.raw=!0)})})});